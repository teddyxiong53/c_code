import os, sys, rtconfig

RTT_ROOT = os.path.normpath(os.getcwd() + "/../..")

sys.path = sys.path + [os.path.join(RTT_ROOT, "tools")]

from building import *

TARGET = "rtthread." + rtconfig.TARGET_EXT

env = Environment(tools=['mingw'],
	AS = rtconfig.AS, ASFLAGS = rtconfig.ASFLAGS,
	CC = rtconfig.CC, CCFLAGS = rtconfig.CCFLAGS,
	CXX = rtconfig.CXX, CXXFLAGS = rtconfig.CXXFLAGS,
	AR = rtconfig.AR, ARFLAGS = rtconfig.ARFLAGS,
	LINK = rtconfig.LINK, LINKFLAGS = rtconfig.LINKFLAGS
)

env.PrependENVPath("PATH", rtconfig.EXEC_PATH)

Export("RTT_ROOT")
Export("rtconfig")

objs = PrepareBuilding(env, RTT_ROOT, has_libcpu=True)

DoBuilding(TARGET, objs)
